#! /usr/bin/env python

import glob
import sh
from sh import sh
import sys
import os
from pprint import pprint

def find_files(ending=".ipynb"):
    all_files = []
    for root, dirs, files in os.walk("doc/source/notebook"):
        for file in files:
            if file.endswith(".ipynb"):
                all_files.append(os.path.join(root, file))
    return all_files

files = find_files(".ipynb")

for filename in files:
    print "CONVERT   :", filename
    data = {
        'filename': filename,
        'dirname': os.path.dirname(filename),
        'basename': os.path.basename(filename)
        }    
    command  = "cd {dirname} ; ipython nbconvert --to=rst {basename}".format(**data)
    os.system(command)

    os.system("cp -rf notebook docs/source/")
