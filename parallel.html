<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Parallel Shell &mdash; my Cloudmesh Learning documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.1.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.1.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'Learning',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="my Cloudmesh Learning documentation" href="index.html" />
    <link rel="next" title="Cloudmesh" href="cloudmesh/cloudmesh.html" />
    <link rel="prev" title="Shell" href="shell.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">




  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><img src="_static/cm-logo-24.png">
          my Cloudmesh</a>
        <span class="navbar-text navbar-version pull-left"><b>Learning</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="about.html#indepent-study-at-iu">Indepent Study at IU</a><ul>
<li class="toctree-l3"><a class="reference internal" href="about.html#cloud-topics">Cloud Topics</a></li>
<li class="toctree-l3"><a class="reference internal" href="about.html#data-topics">Data Topics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="about.html#studnet-employment-at-iu">Studnet Employment at IU</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="shell.html">Shell</a><ul>
<li class="toctree-l2"><a class="reference internal" href="shell.html#basic-shell-commands">Basic shell commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell.html#editors-that-work-in-a-terminal">Editors that work in a terminal</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Parallel Shell</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#parallel-distributed-shell-pdsh">Parallel Distributed Shell (pdsh)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fabric">Fabric</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cloudmesh-parallel-api">Cloudmesh Parallel API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code">Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cloudmesh/cloudmesh.html">Cloudmesh</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cloudmesh/cloudmesh.html#setup">Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cloudmesh/quickstart.html">Quick Start on your desktop</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/quickstart.html#commands-only-without-description">Commands only without description</a></li>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/quickstart.html#one-line-install-with-curl">One line install with curl</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cloudmesh/setup_openstack.html">Setup Cloudmesh in an Openstack VM for Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="cloudmesh/yaml.html">Creating the yaml file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/yaml.html#adding-futuregrid-openstack-clouds-on-sierra-and-india-to-the-yaml-file">Adding FutureGrid Openstack clouds on sierra and india to the yaml file</a></li>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/yaml.html#adding-futuregrid-openstack-clouds-on-alamo-and-hotel-to-the-yaml-file">Adding FutureGrid OpenStack Clouds on alamo and hotel to the yaml file</a></li>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/yaml.html#adding-hp-cloud-to-the-yaml-file">Adding HP cloud to the yaml file</a></li>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/yaml.html#adding-aws-to-the-yaml-file">Adding AWS to the yaml file</a></li>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/yaml.html#adding-azaure-to-the-yaml-file">Adding Azaure to the yaml file</a></li>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/yaml.html#adding-devstack-to-the-yaml-file">Adding devstack to the yaml file</a></li>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/yaml.html#adding-dreamhost-to-the-yaml-file">Adding dreamhost to the yaml file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cloudmesh/setup_vagrant.html">Setup Cloudmesh in an VirtualBox VM with Vagrant for Testing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/setup_vagrant.html#download-cloudmesh">Download cloudmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/setup_vagrant.html#install-vagrant-and-virtualbox">Install Vagrant and VirtualBox</a></li>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/setup_vagrant.html#install-veewee-optional">Install Veewee (Optional)</a></li>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/setup_vagrant.html#vagrant-up">Vagrant up</a><ul>
<li class="toctree-l5"><a class="reference internal" href="cloudmesh/setup_vagrant.html#futuregrid-portal-id">FutureGrid Portal ID</a></li>
<li class="toctree-l5"><a class="reference internal" href="cloudmesh/setup_vagrant.html#base-image">Base Image</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/setup_vagrant.html#vagrant-ssh">Vagrant ssh</a></li>
<li class="toctree-l4"><a class="reference internal" href="cloudmesh/setup_vagrant.html#virtualenv-and-cm">Virtualenv and cm</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Notebooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="notebook/01_1_hello_cloudmesh.html">Cloudmesh Initialization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="notebook/01_1_hello_cloudmesh.html#version">Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="notebook/01_1_hello_cloudmesh.html#generating-vm-names">Generating VM Names</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html">Cloudmesh Shell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#initialization">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#activating-clouds">Activating Clouds</a><ul>
<li class="toctree-l4"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#activate-the-cloud">activate the cloud</a></li>
<li class="toctree-l4"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#set-default-image">set default image</a></li>
<li class="toctree-l4"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#set-default-flavor">set default flavor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#part2-start-vm">Part2: Start VM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#start-one-vm-on-the-selected-or-default-cloud-using-its-default-image-and-default-flavor">start one vm on the selected or default cloud using its default image and default flavor</a></li>
<li class="toctree-l4"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#check-realtime-vm-status-of-the-cloud">check realtime vm status of the cloud</a></li>
<li class="toctree-l4"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#delete-the-vm-cloud-india-delete-all-vms-of-cloud-india-force-no-user-confirmation">delete the vm (&#8211;cloud=india: delete all vms of cloud india, &#8211;force: no user confirmation)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#part3-start-multiple-vms">Part3: Start multiple VMs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#using-option-count-count">using option &#8211;count=count</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#part4-start-vms-on-different-clouds">Part4: Start VMs on different clouds</a><ul>
<li class="toctree-l4"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#activate-another-cloud">activate another cloud</a></li>
<li class="toctree-l4"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#start-vms-on-two-clouds-separately-users-may-specify-a-vm-group-by-using-option-group-group">start VMs on two clouds separately (users may specify a VM group by using option &#8211;group=group)</a></li>
<li class="toctree-l4"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#check-realtime-vm-status-of-all-active-clouds">check realtime vm status of all active clouds</a></li>
<li class="toctree-l4"><a class="reference internal" href="notebook/02_02_cm_shell_splitme.html#delete-vms-by-group">delete VMs by group</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="notebook/02_03_cm_shell_boot.html">Cloudmesh Shell Boot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="notebook/02_03_cm_shell_boot.html#start-vm">Start VM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="notebook/03_01_vm_sh.html">Provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebook/03_02_cm_shell_notes.html">Specifying a custom label</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebook/03_03_junk.html">Load Command</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rst.html">reStructuredText</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rst.html#sections">Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="rst.html#exceltable">Exceltable</a></li>
<li class="toctree-l2"><a class="reference internal" href="rst.html#autorun">Autorun</a></li>
<li class="toctree-l2"><a class="reference internal" href="rst.html#todo">Todo</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="python/python.html">Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="python/ecosystem.html">Ecosystem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="python/ecosystem.html#virtualenv">virtualenv</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/ecosystem.html#pypi">pypi</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/ecosystem.html#github">github</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="python/ecosystem.html#python-resources">Python resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="python/language.html">Lanaguage Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="python/language.html#print">Print</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/language.html#comments">Comments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="python/language.html#simple-comment">Simple comment</a></li>
<li class="toctree-l4"><a class="reference internal" href="python/language.html#multiline-comment-with">Multiline Comment with &#8220;</a></li>
<li class="toctree-l4"><a class="reference internal" href="python/language.html#id1">Multiline Comment with &#8216;</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="python/language.html#variables">Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="python/language.html#changing-the-variable-value">Changing the variable Value</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="python/language.html#list">List</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/language.html#for-loop">For Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/language.html#if-condition">If Condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/language.html#arithmetic-operators">Arithmetic Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/language.html#functions">Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="python/language.html#function-to-do-calculations">Function to do calculations</a></li>
<li class="toctree-l4"><a class="reference internal" href="python/language.html#functions-for-string-manipulation">Functions for String Manipulation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="python/language.html#excersises">Excersises</a></li>
<li class="toctree-l2"><a class="reference internal" href="python/programs.html">Code Listings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#booting-a-virtual-machine">Booting a virtual machine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="python/programs.html#boot-with-a-shell-command">Boot with  a shell command</a></li>
<li class="toctree-l4"><a class="reference internal" href="python/programs.html#boot-with-python-calling-a-shell-command">Boot with python calling a shell command</a></li>
<li class="toctree-l4"><a class="reference internal" href="python/programs.html#boot-with-cloudmesh">Boot with cloudmesh</a></li>
<li class="toctree-l4"><a class="reference internal" href="python/programs.html#deleting-virtual-machines">Deleting virtual machines</a></li>
<li class="toctree-l4"><a class="reference internal" href="python/programs.html#delete-with-a-shell-command">Delete with  a shell command</a></li>
<li class="toctree-l4"><a class="reference internal" href="python/programs.html#delete-with-python-calling-a-shell-command">Delete with python calling a shell command</a></li>
<li class="toctree-l4"><a class="reference internal" href="python/programs.html#delete-with-cloudmesh">Delete with cloudmesh</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#query-to-cloud">Query to Cloud</a><ul>
<li class="toctree-l4"><a class="reference internal" href="python/programs.html#list-flavors">List Flavors</a></li>
<li class="toctree-l4"><a class="reference internal" href="python/programs.html#list-images">List Images</a></li>
<li class="toctree-l4"><a class="reference internal" href="python/programs.html#list-virtual-machines">List Virtual machines</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="python/programs.html#to-integarte">TO INTEGARTE</a><ul>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#cloud0-delete-vm-py">cloud0-delete-vm.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#cloud0-satrt-vm-simulator-py">cloud0-satrt-vm-simulator.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#cloud0-start-vm-py">cloud0-start-vm.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#cloud1-py">cloud1.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#cloud2-py">cloud2.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#cloud3-py">cloud3.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#cloud4-py">cloud4.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#junk-py">junk.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#tabel2-py">tabel2.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#table1-py">table1.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#table3-py">table3.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#table4-py">table4.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#table5-py">table5.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#table6-py">table6.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#table7-py">table7.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/programs.html#table8-py">table8.py</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Tasks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tasks.html#longterm">Longterm</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks.html#learning">Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks.html#programming">Programming</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">ToDo</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Parallel Shell</a><ul>
<li><a class="reference internal" href="#parallel-distributed-shell-pdsh">Parallel Distributed Shell (pdsh)</a></li>
<li><a class="reference internal" href="#fabric">Fabric</a></li>
<li><a class="reference internal" href="#cloudmesh-parallel-api">Cloudmesh Parallel API</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#code">Code</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercise">Exercise</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="shell.html" title="Previous Chapter: Shell"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; Shell</span>
    </a>
  </li>
  <li>
    <a href="cloudmesh/cloudmesh.html" title="Next Chapter: Cloudmesh"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">Cloudmesh &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/parallel.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">
  <h4 class="nav-header">Site Contents</h4>

  <ul class="nav nav-list">  
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell.html">Shell</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Parallel Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloudmesh/cloudmesh.html">Cloudmesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="rst.html">reStructuredText</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="python/python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">ToDo</a></li>
</ul>

  </ul>


<h4 class="nav-header">Page Contents</h4><ul>
<li><a class="reference internal" href="#">Parallel Shell</a><ul>
<li><a class="reference internal" href="#parallel-distributed-shell-pdsh">Parallel Distributed Shell (pdsh)</a></li>
<li><a class="reference internal" href="#fabric">Fabric</a></li>
<li><a class="reference internal" href="#cloudmesh-parallel-api">Cloudmesh Parallel API</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#code">Code</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercise">Exercise</a></li>
</ul>
</li>
</ul>

<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
<div id="sourcelink">
  <a href="_sources/parallel.txt"
     rel="nofollow">Source</a>
</div>
        </div>
      </div>
    <div class="col-md-9">
      
  <div class="section" id="parallel-shell">
<h1>Parallel Shell<a class="headerlink" href="#parallel-shell" title="Permalink to this headline">¶</a></h1>
<p>Traditionally system administrators and developers using parallel computing need tools to manage a significant number of machines. One of the requirements is to execute a command in parallel on many machines and gather its output. There are many tools that can achieve this task. We focus here on the introduction of the following tools:</p>
<ol class="arabic simple">
<li>pdsh - a parallel distributed shell</li>
<li>fabric - python framework to execute commands on remote computers</li>
<li>Cloudmesh Sequential and Parallel python functions for
executing repeatedly commands with caching</li>
</ol>
<div class="section" id="parallel-distributed-shell-pdsh">
<h2>Parallel Distributed Shell (pdsh)<a class="headerlink" href="#parallel-distributed-shell-pdsh" title="Permalink to this headline">¶</a></h2>
<p>The parallel distributed shell (pdsh) is a shell command line program that allows the execution of commands not just on one computer but on a list of computers.</p>
<p>An online version of the manual pages is located at</p>
<ul class="simple">
<li><a class="reference external" href="http://linux.die.net/man/1/pdsh">http://linux.die.net/man/1/pdsh</a></li>
</ul>
<p>An important feature is that the list of hosts can be specified in a convenient form that is also kwon as hostlists. This format allows you to define a list of hosts based on some abreviation. For example the string:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">host</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>will create a host list containing the hosts:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">host0</span><span class="p">,</span> <span class="n">host1</span><span class="p">,</span> <span class="n">host2</span><span class="p">,</span> <span class="n">host3</span>
</pre></div>
</div>
<p>Furthermore, substitutions for the user and the hostname to login to the remote machine while leveraging ssh config files make this tool real easy to use. One such example:</p>
<div class="highlight-python"><div class="highlight"><pre>pdsh -R exec -w host[0-3] ssh -x -l %u %h hostname
</pre></div>
</div>
<p>executes the command hostname on all specified machines.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">At this time we are not aware that pdsh is installed by
default on india. check with the systems group and have them
provide a documentation on how we activate it.</p>
</div>
</div>
<div class="section" id="fabric">
<h2>Fabric<a class="headerlink" href="#fabric" title="Permalink to this headline">¶</a></h2>
<p>Fabric is a Python command-line tool and library for assiting system
administration tasks related to the execution of command via ssh. It
includes the ability to execute commands on the local machine, but
also on a remote machine. Due to the integration with Python function
definitions, it has also somewhat the ability to write &#8220;target&#8221; like
specifications that we may know from makefiles. However it is more
sophisticated as we can use the full feature richness of python.</p>
<p>The web page of Fabric which includes several examples and tutorials
is located at:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.fabfile.org">http://www.fabfile.org</a></li>
</ul>
<p>Similar to the previous command we like to start the command hostname
on a number of machines. To install vfabric you simply say:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install fabric
</pre></div>
</div>
<p>in your virtualenv. Next, we define a file called fabfile.py with the following contents:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">fabric.api</span> <span class="kn">import</span> <span class="n">run</span>

<span class="k">def</span> <span class="nf">hostname</span><span class="p">():</span>
    <span class="n">run</span><span class="p">(</span><span class="s">&#39;hostname&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next let us run this command on the local computer and test it out:</p>
<div class="highlight-python"><div class="highlight"><pre>fab -H localhost hostname
</pre></div>
</div>
<p>This will execute the function defined with the name hostname and
print it via the run command. To execute the command on multiple
hosts, you can simply specify them as part of the -H argument:</p>
<div class="highlight-python"><div class="highlight"><pre>fab -H host0,host1,host2,host3 hostname
</pre></div>
</div>
</div>
<div class="section" id="cloudmesh-parallel-api">
<h2>Cloudmesh Parallel API<a class="headerlink" href="#cloudmesh-parallel-api" title="Permalink to this headline">¶</a></h2>
<p>The previous commands are all developeed with a single user in mind,
i.e. a single user executes the command. Howeve in the age of
cloudcomputing what would happen if thausends of users were to execute
the same task, or even when ten users execute the same task, but the
task would take considerable compute time to calculate? The answer is
obvious, we woudl waste valuable compute resources as we do not take
into consideration that the same task may be run by multiple
people. To overcome this challange we have started a simple
demonstartion program in our cloudmesh repository to partially address
this issue.</p>
<p>To do so we are at this time we are only focussing on the consecutive
execution of a command in a particular time period. Instead of
executing the command over and over, we will simply return the result
from a result cache. The cache has a specific time to life in which no
new results are created but the result is read from the cache. New
requests are cached.</p>
<p>We recognize that the example we provide is not a complete solution to
our problem, but a step in the right direction. I also has the
advantage of being relatively simple and introducing you to a number
of tools and concepts that will become important when dealing with
aparalelism in the cloud.</p>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>A computer with python 2.7</li>
<li>Using a python virtualenv</li>
<li>Having downloaded the cloudmesh code with git clone as discussed
elsewhere</li>
<li>Having installed the cloudmesh code and libraries as discussed
elsewhere</li>
</ol>
</div>
<div class="section" id="code">
<h3>Code<a class="headerlink" href="#code" title="Permalink to this headline">¶</a></h3>
<p>The code is located in the dicrectory:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cloudmesh_examples</span><span class="o">/</span><span class="n">example_mongo</span>
</pre></div>
</div>
<p>within the cloudmesh code you have cloened from github. The code
contains two python functions called Sequential and Parallel, that
allow users to run commnads either sequentially or in parallel on a
number of hosts. The hosts can be specified in a yaml file located
in:</p>
<div class="highlight-python"><div class="highlight"><pre>~/.cloudmesh/cloudmesh_hpc.yaml
</pre></div>
</div>
<p>An example would be:</p>
<div class="highlight-python"><div class="highlight"><pre>meta:
  yaml_version: 3.0
  kind: hpc
cloudmesh:
    hpc:
        alamo:
            cm_host: alamo.futuregrid.org
            cm_type: hpc
            username: albert
        india:
            cm_host: india.futuregrid.org
            cm_type: hpc
            username: albert
        sierra:
            cm_host: sierra.futuregrid.org
            cm_type: hpc
            username: albert
        bigred:
            cm_host: bigred2.uits.iu.edu
            cm_type: hpc
            username: albert
</pre></div>
</div>
<p>This file is used to specify the username for each host and define the
host names. In case you want to run commands on the hosts you can do
this with the following python program.</p>
<p>The first command executes the task sequentially over the array given
in the first parameter. The second one executes it in
parallel. Instead of just presenting you with a bare bones program we
present you with some additional features that are worth noting and
may come in handy in future. THis includes the availability of a named
stopwatch and the ability to read configuration parameters easily from
a yaml file. Sometimes it is allso nice to have very visible debug
messages that we create with a banner function. Reults are often more
readable when using the python pprint fucntion instead of just the
print function. This is especially true when we print datastructures
such as arrays and dicts. Next we will present the program and explain
a selected number of features by commenting them in the code. We
assume you know by now elementary python.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cloudmesh_task.tasks</span> <span class="kn">import</span> <span class="n">cm_ssh</span>
<span class="kn">from</span> <span class="nn">cloudmesh_task.parallel</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">cloudmesh.util.stopwatch</span> <span class="kn">import</span> <span class="n">StopWatch</span>
<span class="kn">from</span> <span class="nn">cloudmesh_common.util</span> <span class="kn">import</span> <span class="n">banner</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">cloudmesh.config.cm_config</span> <span class="kn">import</span> <span class="n">cm_config</span>
<span class="kn">from</span> <span class="nn">cloudmesh.config.ConfigDict</span> <span class="kn">import</span> <span class="n">ConfigDict</span>
<span class="kn">import</span> <span class="nn">sys</span>


<span class="c"># read the information from the yaml file into a dict called config</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">ConfigDict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s">&quot;~/.cloudmesh/cloudmesh_hpc.yaml&quot;</span><span class="p">)[</span><span class="s">&quot;cloudmesh&quot;</span><span class="p">][</span><span class="s">&quot;hpc&quot;</span><span class="p">]</span>

<span class="c"># a function to extract from the config file the username from all</span>
<span class="c"># hostnames in the array hosts</span>
<span class="k">def</span>  <span class="nf">get_credentials</span><span class="p">(</span><span class="n">hosts</span><span class="p">):</span>
    <span class="n">credential</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">host</span> <span class="ow">in</span> <span class="n">hosts</span><span class="p">:</span>
        <span class="n">credential</span><span class="p">[</span><span class="n">host</span><span class="p">]</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="n">host</span><span class="p">][</span><span class="s">&#39;username&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">credential</span>

<span class="c"># find all hostnames from the config file</span>
<span class="n">hosts</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

<span class="c"># find all creadentals (username, hostname) from the hosts in the</span>
<span class="c">#  config file</span>
<span class="n">credentials</span> <span class="o">=</span> <span class="n">get_credentials</span><span class="p">(</span><span class="n">hosts</span><span class="p">)</span>


<span class="c"># create a stop watch</span>
<span class="n">watch</span> <span class="o">=</span> <span class="n">StopWatch</span><span class="p">()</span>

<span class="c"># execute is a python function. It is eitehr Parallel or Sequential</span>
<span class="c"># * modify</span>
<span class="c">#    for execute in [Sequential]:</span>
<span class="c">#    for execute in [Parallel]:</span>

<span class="k">for</span> <span class="n">execute</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Sequential</span><span class="p">,</span> <span class="n">Parallel</span><span class="p">]:</span>

    <span class="c"># get the name of the function</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">execute</span><span class="o">.</span><span class="n">__name__</span>

    <span class="c"># print the name of the function and start the timer</span>
    <span class="n">banner</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">watch</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="c"># execute the function and return the result in a dict</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">credentials</span><span class="p">,</span> <span class="n">cm_ssh</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="s">&quot;qstat&quot;</span><span class="p">)</span>

    <span class="c"># stop the timer and print the result dict</span>
    <span class="n">watch</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="c"># only print the output from the command we executed</span>
    <span class="n">banner</span><span class="p">(</span><span class="s">&quot;PRINT&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">host</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">result</span><span class="p">[</span><span class="n">host</span><span class="p">][</span><span class="s">&quot;output&quot;</span><span class="p">]</span>

<span class="c"># print the timers</span>
<span class="k">for</span> <span class="n">timer</span> <span class="ow">in</span> <span class="n">watch</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">print</span> <span class="n">timer</span><span class="p">,</span> <span class="n">watch</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timer</span><span class="p">),</span> <span class="s">&quot;s&quot;</span>
</pre></div>
</div>
<p>Bug: Before you start the command, you have to start a new window and
say fab fab manage.mongo in the cloudmesh directory where your
fabfiles are located. This will give something like:</p>
<div class="highlight-python"><div class="highlight"><pre>$ fab manage.mongo
[localhost] local: make -f cloudmesh/management/Makefile mongo
mongod --noauth --dbpath . --port 27777
all output going to: /usr/local/var/log/mongodb/mongo.log
</pre></div>
</div>
<p>To run the command you will need to start the caching backend
services. to do so we created a simple program cm-task.py that will be
used to start and stop the services:</p>
<div class="highlight-python"><div class="highlight"><pre>./cm-tasks.py menu

Queue Management
================

    1 - all start
    2 - all stop
    3 - rabbit start
    4 - celery start
    5 - rabbit stop
    6 - celery stop
    7 - mongo start
    q - quit

Select between 1 - 7:
</pre></div>
</div>
<p>Now select the number:</p>
<div class="highlight-python"><div class="highlight"><pre>1 - all start
</pre></div>
</div>
<p>This will bring up the necessary services and look similar to:</p>
<div class="highlight-python"><div class="highlight"><pre> -------------- celery@host.local v3.1.13 (Cipater)
---- **** -----
--- * ***  * -- Darwin-13.3.0-x86_64-i386-64bit
-- * - **** ---
- ** ---------- [config]
- ** ---------- .&gt; app:         cloudmesh_task:0x10365bcd0
- ** ---------- .&gt; transport:   amqp://guest:**@localhost:5672//
- ** ---------- .&gt; results:     amqp
- *** --- * --- .&gt; concurrency: 10 (prefork)
-- ******* ----
--- ***** ----- [queues]
 -------------- .&gt; celery           exchange=celery(direct) key=celery


[tasks]
  . cloudmesh_task.tasks.cm_ssh

[2014-08-19 15:46:24,060: INFO/MainProcess] Connected to amqp://guest:**@localhost:5672//
[2014-08-19 15:46:24,071: INFO/MainProcess] mingle: searching for neighbors
[2014-08-19 15:46:25,098: INFO/MainProcess] mingle: sync with 10 nodes
[2014-08-19 15:46:25,099: INFO/MainProcess] mingle: sync complete
[2014-08-19 15:46:25,109: WARNING/MainProcess] celery@host.local ready.
[2014-08-19 15:46:28,352: INFO/MainProcess] Events of group {task} enabled by remote.
</pre></div>
</div>
<p>After this you can start the program repeatedly with:</p>
<div class="highlight-python"><div class="highlight"><pre>$ python prg.py
</pre></div>
</div>
<p>We are ommitting some of the output but at the end ist shoul look
something like:</p>
<div class="highlight-python"><div class="highlight"><pre># ######################################################################
# PRINT
# ######################################################################
Tue Aug 19 15:48:29 EDT 2014
Job id                    Name             User            Time Use S Queue
------------------------- ---------------- --------------- -------- - -----
1589570.i136               sub18248.sub     aaaa                   0 Q delta
1589589.i136               sub15366.sub     aaaa                   0 Q delta
1589669.i136               sub12428.sub     aaaa                   0 Q delta
1795838.i136               twisterJob       bbbbbb                 0 Q batch
1872981.i136               sub9593.sub      aaaa                   0 Q delta
1904453.i136               sub2114.sub      aaaa                   0 Q delta
1904930.i136               dimer_in_sol_ph7 cccccccc        883:55:5 R batch
1904931.i136               dimer_in_sol_ph5 cccccccc        902:18:4 R batch
1904957.i136               suffix           dddddddd        360:36:1 R echo
1904961.i136               dimer_in_sol_ph7 cccccccc               0 H batch
1904963.i136               dimer_in_sol_ph5 cccccccc               0 H batch
1904993.i136               blast            eeee            15:08:00 R bravo
1904995.i136               blast            eeee            14:33:19 R bravo
1905016.i136               papi-inca        aaaa                   0 Q bravo
1905021.i136               vampir-inca      aaaa                   0 Q bravo
1905044.i136               papi-inca        aaaa                   0 Q bravo
1905057.i136               STDIN            ffffffff        00:10:17 R delta
1905062.i136               ...Script.i21500 gggggg          00:00:11 R batch

Sequential 12.12866169 s
Parallel    0.00446796417236 s
</pre></div>
</div>
<p>Please note that we have replaced the real usernames.</p>
<p>When you execute this command you will notice That the parallel
execution time is much faster. In this case it was within the TTL and
thus read the cache value from the cache. Executing the command again
within the TTL will give you also for the sequential time a real short
value:</p>
<div class="highlight-python"><div class="highlight"><pre>Sequential 0.00726103782654 s
Parallel   0.000990867614746 s
</pre></div>
</div>
<p>It is not surprising the the parallel result is even faster than the
sequentail one as the information gathering even from reading it out
from the cache is done in parallel and no resource congestion exists
at the scale we use for our example.</p>
<p>Let us now compare the true time between sequentaial and parallel
execution. Simply modify the code in the * line and replace the loop accordingly:</p>
<div class="highlight-python"><div class="highlight"><pre>Sequential 12.681866169 s
Parallel    6.51530909538 s
</pre></div>
</div>
<p>Thus we see two interesting perfomance improvements</p>
<p>First, the perfomance improvement for running the queries in
parallel. Second, the improvement of retrieving the results from a
cache. The later is important if we have many user on the system
executing the same command.</p>
<p>The lesson we learn is that clouds must make use of execution
paralleleism as well as addressung reuse of repeated results.</p>
</div>
</div>
<div class="section" id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Is pdsh installed? Where</li>
<li>Return the hostname of the machines sierrs, india and foxtrot via
the fabric command</li>
<li>Execute the command qstat with fabric on sierra and india. If you
have an account on bigred2, please try it also there</li>
<li>Run the cloudmesh Sequential and parallel program. Modify your
cloudmesh file accordingly</li>
<li>Advanced: compare the performance of the cachebackend between
Mongodb and the use of RabbitMQ while switching RabbitMQ out with
Redis in the Celery code.</li>
<li>Advanced: provide a documentation on how to run celery for this
example  on Redis.</li>
</ol>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013, Gregor von Laszewski for FutureGrid.<br/>
    </p>
  </div>
</footer>
  </body>
</html>